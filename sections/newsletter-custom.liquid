{% comment %}
Custom Newsletter Section (No-Crop Images)
- Desktop & Mobile images shown "as is" (no background cropping)
- Uses <picture> + <img> with width:100% & height:auto
- RTL friendly
- Responsive
- Works with Shopify 'customer' newsletter form
{% endcomment %}

<div class="newsletter-custom-section align-{{ section.settings.text_align }} {% if section.settings.enable_rtl %}rtl-enabled{% endif %}">

  <style>
{% if request.locale.iso_code == 'en' %}
    // ENGLISH CODE HERE ...
{% else %}
    // ARABIC CODE HERE ...
    /* --- RTL --- */
    {% comment %} .rtl-enabled .newsletter-content {
      direction: rtl;
      text-align: right;
    } {% endcomment %}

.rtl-flip {
  transform: scaleX(-1);
  transform-origin: center;
} 
.align-left .newsletter-content {
    text-align: right !important;
}

{% endif %}

/* Sirf RTL layout me flip */
 [dir="rtl"] .rtl-flip {
  transform: scaleX(-1);
  transform-origin: center;
} 


/* Force white text in the newsletter email field */
form[action*="contact#newsletter"] input[type="email"],
form[action*="/contact"] input[name="contact[email]"],
.newsletter-form input[type="email"] {
  color: #fff !important;
  -webkit-text-fill-color: #fff !important;  /* Chrome/Safari */
  caret-color: #fff !important;
  background: transparent !important;
  border-color: #fff !important; /* optional: white underline/border */
}

/* Placeholder text white (and fully opaque) */
form[action*="contact#newsletter"] input[type="email"]::placeholder,
form[action*="/contact"] input[name="contact[email]"]::placeholder,
.newsletter-form input[type="email"]::placeholder {
  color: rgba(255,255,255,0.9) !important;
  opacity: 1 !important;  /* some themes set placeholder opacity */
}

/* Chrome/Safari autofill fix: remove yellow bg and force white text */
form[action*="contact#newsletter"] input[type="email"]:-webkit-autofill,
form[action*="/contact"] input[name="contact[email]"]:-webkit-autofill,
.newsletter-form input[type="email"]:-webkit-autofill {
  -webkit-text-fill-color: #fff !important;
  box-shadow: 0 0 0px 1000px transparent inset !important; /* hide yellow */
  -webkit-box-shadow: 0 0 0px 1000px transparent inset !important;
  transition: background-color 9999s ease-in-out 0s !important; /* keep it transparent */
}

/* If the theme applies color to a nested span/input wrapper, neutralize it */
.newsletter-form *,
.newsletter-content * {
  color: inherit;
}





    .newsletter-custom-section {
      position: relative;
      color: {{ section.settings.text_color }};
      /* section spans the natural height of the image */

      font-family: "Outfit", sans-serif !important;
    }

    /* --- IMAGE: shown exactly as-is (no crop) --- */
    .newsletter-media picture,
    .newsletter-media img {
      display: block;
      width: 100%;
      height: auto; /* <- keeps image proportions, no cutting */
    }

    /* --- OVERLAY CONTENT ON TOP OF IMAGE --- */
    .newsletter-overlay {
      position: absolute;
      inset: 0;               /* cover the whole image area */
      display: flex;
      align-items: center;    /* vertical centering */
      padding: 80px 40px;
      pointer-events: none;   /* so clicks pass through except on inner content */
    }

    .newsletter-content {
      max-width: 640px;
      pointer-events: auto;   /* re-enable interaction for form */
    }

    .newsletter-title {
      text-transform: capitalize;  
       color: #fff;
      font-size: 4rem;
      font-weight: 400;
      margin: 0 0 12px 0;
          text-shadow: 1px 1px 2px black;
    }

    .newsletter-desc {
      font-size: 1.6rem;
      margin: 0 0 24px 0;
      color: #fff;
      text-shadow: 1px 1px 2px black;
    }

    /* --- FORM --- */
    .newsletter-form {
      display: flex;
      
      flex-direction: row;
      gap: 10px;
      align-items: center;
      border-bottom: 1px solid #fff;
      padding-bottom: 10px;
      margin-bottom: 16px;
    }

    .newsletter-form input[type="email"] {
      flex: 1;
      border: none;
      background: transparent;
      outline: none;
     color: #fff;
      font-size: 15px;
    }

    .newsletter-form button {
      background: #fff;
      color: #000;
      border: none;
      padding: 10px 18px;
      cursor: pointer;
     font-size: 1.4rem;
    font-weight: 400;
    }

    .newsletter-checkbox {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1rem;
      margin-top: 4px;
      color: #fff;
    }

    /* --- ALIGNMENT OPTIONS --- */
    .align-left .newsletter-overlay  { justify-content: flex-start; }
    .align-center .newsletter-overlay{ justify-content: center; }
    .align-right .newsletter-overlay { justify-content: flex-end; }

    .align-left .newsletter-content   { text-align: left; }
    .align-center .newsletter-content { text-align: center; }
    .align-right .newsletter-content  { text-align: right; }

   

    /* --- RESPONSIVE --- */
    @media (max-width: 768px) {
      .newsletter-form button {width:100%;   }
.newsletter-form {
    display: flex;
    flex-direction: column;
    gap: 10px;
    align-items: flex-start;
    border-bottom: none;
}


       .newsletter-desc { font-size: 1.2rem;}
      .newsletter-overlay { padding: 40px 20px; }
      .newsletter-title { font-size: 32px; }
    }
  </style>

  <!-- IMAGE: show as-is using picture -->
  <div class="newsletter-media">
    <picture>
      {%- if section.settings.mobile_image != blank -%}
        <source media="(max-width: 768px)" srcset="{{ section.settings.mobile_image | img_url: '1200x' }}">
      {%- endif -%}
      {%- if section.settings.desktop_image != blank -%}
        <img
         class="rtl-flip"
          src="{{ section.settings.desktop_image | img_url: '2000x' }}"
          alt="{{ section.settings.heading | escape }}"
          loading="lazy">
      {%- endif -%}
    </picture>
  </div>

  <!-- OVERLAY CONTENT -->
  <div class="newsletter-overlay">
    <div class="newsletter-content">
      {%- if section.settings.heading != blank -%}
        <h2 class="newsletter-title">{{ section.settings.heading }}</h2>
      {%- endif -%}

      {%- if section.settings.description != blank -%}
        <p class="newsletter-desc">{{ section.settings.description }}</p>
      {%- endif -%}

      {% form 'customer', id: 'custom-newsletter' %}
        {% if form.posted_successfully? %}
          <p class="newsletter-success" role="status">{{ 'general.newsletter_form.confirmation' | t }}</p>
        {% endif %}

        {% if form.errors %}
          <div class="newsletter-errors" role="alert">
            {{ form.errors | default_errors }}
          </div>
        {% endif %}

        <div class="newsletter-form">
          <input
            type="email"
            name="contact[email]"
            placeholder="{{ section.settings.email_placeholder }}"
            required
            aria-label="{{ section.settings.email_placeholder }}">
          <button type="submit">{{ section.settings.btn_text }}</button>
        </div>

        {% if section.settings.show_checkbox %}
          <label class="newsletter-checkbox">
            <input class="newsletter-checkbox_mark" type="checkbox" required>
            {{ section.settings.checkbox_text }}
          </label>
        {% endif %}

        <input type="hidden" name="contact[tags]" value="newsletter">
      {% endform %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Custom Newsletter",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Footer newsletter title" },
    { "type": "textarea", "id": "description", "label": "Description", "default": "Footer newsletter description" },

    { "type": "text", "id": "email_placeholder", "label": "Email placeholder", "default": "Enter your email address" },
    { "type": "text", "id": "btn_text", "label": "Button text", "default": "Subscribe" },

    { "type": "image_picker", "id": "desktop_image", "label": "Desktop image" },
    { "type": "image_picker", "id": "mobile_image", "label": "Mobile image (<= 768px)" },

    { "type": "select", "id": "text_align", "label": "Text alignment", "default": "left",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },

    { "type": "color", "id": "text_color", "label": "Text color", "default": "#ffffff" },

    { "type": "checkbox", "id": "show_checkbox", "label": "Show consent checkbox", "default": true },
    { "type": "text", "id": "checkbox_text", "label": "Checkbox text", "default": "Newsletter" },

    { "type": "checkbox", "id": "enable_rtl", "label": "Enable RTL layout", "default": false }
  ],
  "presets": [
    { "name": "Custom Newsletter" }
  ]
}
{% endschema %}
